@using SFA.DAS.CommitmentsV2.Shared.Extensions
@using SFA.DAS.ProviderCommitments.Web.RouteValues
@model SFA.DAS.ProviderCommitments.Web.Models.Apprentice.ChangeOfEmployerViewModel

@{
    ViewBag.Title = "Confirm the information before sending your request";
    ViewBag.GaData.Vpv = "/apprentices/change-employer/confirm";
}

<div class="govuk-grid-row">
    <div class="govuk-grid-column-two-thirds">
        <h1 class="govuk-heading-xl">@ViewBag.Title</h1>

        @if (Model.ExceedsFundingBandCap)
        {
            <div class="govuk-inset-text das-inset-text--highlight">
                <h3 class="govuk-heading-s">The apprenticeship is above the funding band maximum</h3>
                <p>
                    The new agreed apprenticeship price is above the @DisplayCost(Model.FundingBandCap.Value) <a target="_blank" href="https://www.gov.uk/government/publications/apprenticeship-funding-bands">maximum value for the funding band</a> for this apprenticeship.
                    You'll need to ask the new employer to pay the difference directly to you - this can be funded from their account.

                    @*<text>@course.FundingBandExcess.DisplaySingleFundingBandCap</text>
        You'll need to pay the difference directly to the training provider.*@
                </p>
            </div>
        }

        <table class="govuk-table">
            <tbody class="govuk-table__body">
                <tr class="govuk-table__row">
                    <th scope="row" class="govuk-table__header das-table-cell-width-45">Apprentice name</th>
                    <td class="govuk-table__cell das-table-cell-width-40">@Model.ApprenticeName</td>
                    <td class="govuk-table__cell">&nbsp;</td>
                    </td>
                </tr>
            </tbody>
        </table>
        <h2 class="govuk-heading-m govuk-!-margin-top-9">Current details</h2>
        <table class="govuk-table">
            <tbody class="govuk-table__body">
                <tr class="govuk-table__row">
                    <th scope="row" class="govuk-table__header das-table-cell-width-45">Employer</th>
                    <td class="govuk-table__cell das-table-cell-width-40">@Model.OldEmployerName</td>
                    <td class="govuk-table__cell">&nbsp;</td>
                </tr>
                <tr class="govuk-table__row">
                    <th scope="row" class="govuk-table__header">Training start date</th>
                    <td class="govuk-table__cell" @DisplayDate(Model.OldStartDate)</td>
                    <td class="govuk-table__cell">&nbsp;</td>
                </tr>
                <tr class="govuk-table__row">
                    <th scope="row" class="govuk-table__header">Stop applies from</th>
                    <td class="govuk-table__cell">@DisplayDate(Model.StopDate)</td>
                    <td class="govuk-table__cell">&nbsp;</td>
                </tr>
                <tr class="govuk-table__row">
                    <th scope="row" class="govuk-table__header">Total agreed apprenticeship price</th>
                    <td class="govuk-table__cell">@DisplayCost(Model.OldPrice)</td>
                    <td class="govuk-table__cell">&nbsp;</td>
                </tr>
            </tbody>
        </table>
        <h2 class="govuk-heading-m govuk-!-margin-top-9">Requested changes</h2>
        <table class="govuk-table">
            <tbody class="govuk-table__body">
                <tr class="govuk-table__row">
                    <th scope="row" class="govuk-table__header das-table-cell-width-45">New Employer</th>
                    <td class="govuk-table__cell das-table-cell-width-40">@Model.NewEmployerName</td>
                    <td class="govuk-table__cell">&nbsp;</td>
                </tr>
                <tr class="govuk-table__row">
                    <th scope="row" class="govuk-table__header">New training start date</th>
                    <td class="govuk-table__cell">@DisplayDate(Model.OldStartDate)</td>
                    <td class="govuk-table__cell">
                        <a class="govuk-link" href="#">Change</a>
                    </td>
                </tr>
                <tr class="govuk-table__row">
                    <th scope="row" class="govuk-table__header">New agreed apprenticeship price</th>
                    <td class="govuk-table__cell">@DisplayCost(Model.NewPrice)</td>
                    <td class="govuk-table__cell">
                        <a class="govuk-link" href="#">Change</a>
                    </td>
                </tr>
            </tbody>
        </table>
    </div>
</div>


@functions
{
    private string DisplayDate(DateTime value)
    {
        return $"{value:MMMM yyyy}";
    }

    private string DisplayCost(int value)
    {
        return value.ToGdsCostFormat();
    }
}


@section breadcrumb
{
    <a id="back-link" class="govuk-back-link" href="@Url.RouteUrl(RouteNames.ApprenticePrice, new { Model.EmployerAccountLegalEntityPublicHashedId.Length, Model.NewStartDate})">Back</a>
}